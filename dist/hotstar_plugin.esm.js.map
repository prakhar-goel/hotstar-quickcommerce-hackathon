{"version":3,"file":"hotstar_plugin.esm.js","sources":["../node_modules/style-inject/dist/style-inject.es.js","../src/version.ts","../src/config.ts","../src/utils.ts","../src/app.ts","../src/index.ts"],"sourcesContent":["function styleInject(css, ref) {\n  if ( ref === void 0 ) ref = {};\n  var insertAt = ref.insertAt;\n\n  if (!css || typeof document === 'undefined') { return; }\n\n  var head = document.head || document.getElementsByTagName('head')[0];\n  var style = document.createElement('style');\n  style.type = 'text/css';\n\n  if (insertAt === 'top') {\n    if (head.firstChild) {\n      head.insertBefore(style, head.firstChild);\n    } else {\n      head.appendChild(style);\n    }\n  } else {\n    head.appendChild(style);\n  }\n\n  if (style.styleSheet) {\n    style.styleSheet.cssText = css;\n  } else {\n    style.appendChild(document.createTextNode(css));\n  }\n}\n\nexport default styleInject;\n","export const LIB_VERSION = \"0.1.18\";\n","import { Config } from \"./types\"\nconst config: Config = {\n    GoogleAnalyticsCode: 'G-G5RBRDVPCF',\n    AdComponentElementId: 'hotstar_ad_plugin',\n    DataAttribute: 'data-displaymaxtap',\n    classNames: {\n        image_wrapper: \"maxtap_img_wrapper\",\n    },\n    PrefetchImageTime: 15,\n    DataUrl: \"https://storage.googleapis.com/publicmaxtap-prod.appspot.com/data\"\n}\n\nexport const shoppingBagSvg = `<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\" class=\"feather feather-shopping-bag\"><path d=\"M6 2L3 6v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6l-3-4z\"></path><line x1=\"3\" y1=\"6\" x2=\"21\" y2=\"6\"></line><path d=\"M16 10a4 4 0 0 1-8 0\"></path></svg>`\nexport const clockSvg =`<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"#fff\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\" class=\"feather feather-clock\"><circle cx=\"12\" cy=\"12\" r=\"10\"></circle><polyline points=\"12 6 12 12 16 14\"></polyline></svg>`\nexport default config;","import Config from './config';\nimport { AdComponentData, GaGeneric } from './types';\nimport { LIB_VERSION } from './version';\nimport * as platform from 'platform';\n\nconst sampleData = {\n  '1000063091': {\n    contentId: '1000063091',\n    triggerPoints: [\n      {\n        startTime: 5,\n        endTime: 10,\n        ads: [\n          {\n            imageUrl:\n              'https://media-assets.swiggy.com/swiggy/image/upload/fl_lossy,f_auto,q_auto,h_600/FOOD_CATALOG/IMAGES/CMS/2024/7/4/4e30b1ff-dbe8-41d3-b083-d46b9d742ffc_636d161e-7f34-4371-b63c-bf9e3d091a0f.jpg',\n            title: 'Veg Cheese Pizza',\n            description:\n              'Centre loaded with Molten Cheese & topped with Onion, Capsicum, Tomato & Grilled Mushroom *Contains non-edible container under the Pizza',\n            price: '₹149',\n            previousPrice: '₹299',\n            discount: '50% off for Hotstar users',\n            redirectUrl: 'https://swiggy.com/search?query=dominos+pizza',\n            deliveryTime: '28 mins',\n            brandLogoUrl:\n              'https://raw.githubusercontent.com/prakhar-goel/hotstar-quickcommerce-hackathon/main/assets/brands/swiggy.png',\n            brandColor: '#FC8019',\n            qrData: {\n              qrImageUrl:\n                'https://raw.githubusercontent.com/prakhar-goel/hotstar-quickcommerce-hackathon/main/assets/qr-codes/pizza-swiggy.png',\n              title: 'Cheese Volcano Blazing Chicken',\n            },\n          },\n          // {\n          //   imageUrl:\n          //     'https://media-assets.swiggy.com/swiggy/image/upload/fl_lossy,f_auto,q_auto,h_600/oqaxbzhq3wxnyz09upie',\n          //   title: 'Mango Shrikhand',\n          //   description: 'Our most selling shrikhad with rich kesar taste',\n          //   price: '₹100',\n          //   previousPrice: '₹199',\n          //   discount: '50% off for Hotstar users',\n          //   redirectUrl: 'https://www.swiggy.com/search?query=shrikhand',\n          //   deliveryTime: '7 mins',\n          //   brandColor: '#FC8019',\n          //   brandLogoUrl:\n          //     'https://raw.githubusercontent.com/prakhar-goel/hotstar-quickcommerce-hackathon/main/assets/brands/swiggy.png',\n          //   qrData: {\n          //     qrImageUrl:\n          //       'https://raw.githubusercontent.com/prakhar-goel/hotstar-quickcommerce-hackathon/main/assets/qr-codes/shrikhand-swiggy.png',\n          //     title: 'Mango Shrikhand',\n          //   },\n          // },\n          // {\n          //   imageUrl:\n          //     'https://instamart-media-assets.swiggy.com/swiggy/image/upload/fl_lossy,f_auto,q_auto,h_600/d2fe71ba49d3e43af5d99a3ce3ef5a1b',\n          //   title: 'Amul Fresh Cream',\n          //   description: 'Cook with Sanjeev Kapoor',\n          //   price: '₹220',\n          //   redirectUrl: 'https://swiggy.com/instamart/search?query=cream',\n          //   deliveryTime: '6 mins',\n          //   brandColor: '#FC8019',\n          //   brandLogoUrl:\n          //     'https://raw.githubusercontent.com/prakhar-goel/hotstar-quickcommerce-hackathon/main/assets/brands/swiggy-instamart.png',\n          //   qrData: {\n          //     qrImageUrl:\n          //       'https://raw.githubusercontent.com/prakhar-goel/hotstar-quickcommerce-hackathon/main/assets/qr-codes/amulcream-swiggy.png',\n          //     title: 'Amul Fresh Cream',\n          //   },\n          // },\n        ],\n      },\n      {\n        startTime: 12,\n        endTime: 15,\n        ads: [\n          {\n            imageUrl:\n              'https://media-assets.swiggy.com/swiggy/image/upload/fl_lossy,f_auto,q_auto,h_600/FOOD_CATALOG/IMAGES/CMS/2024/7/4/4e30b1ff-dbe8-41d3-b083-d46b9d742ffc_636d161e-7f34-4371-b63c-bf9e3d091a0f.jpg',\n            title: 'Veg Cheese Pizza',\n            description:\n              'Centre loaded with Molten Cheese & topped with Onion, Capsicum, Tomato & Grilled Mushroom *Contains non-edible container under the Pizza',\n            price: '₹149',\n            previousPrice: '₹299',\n            discount: '50% off for Hotstar users',\n            redirectUrl: 'https://swiggy.com/search?query=dominos+pizza',\n            deliveryTime: '28 mins',\n            brandLogoUrl:\n              'https://raw.githubusercontent.com/prakhar-goel/hotstar-quickcommerce-hackathon/main/assets/brands/swiggy.png',\n            brandColor: '#FC8019',\n            qrData: {\n              qrImageUrl:\n                'https://raw.githubusercontent.com/prakhar-goel/hotstar-quickcommerce-hackathon/main/assets/qr-codes/pizza-swiggy.png',\n              title: 'Cheese Volcano Blazing Chicken',\n            },\n          },\n          {\n            imageUrl:\n              'https://media-assets.swiggy.com/swiggy/image/upload/fl_lossy,f_auto,q_auto,h_600/oqaxbzhq3wxnyz09upie',\n            title: 'Mango Shrikhand',\n            description: 'Our most selling shrikhad with rich kesar taste',\n            price: '₹100',\n            previousPrice: '₹199',\n            discount: '50% off for Hotstar users',\n            redirectUrl: 'https://www.swiggy.com/search?query=shrikhand',\n            deliveryTime: '7 mins',\n            brandColor: '#FC8019',\n            brandLogoUrl:\n              'https://raw.githubusercontent.com/prakhar-goel/hotstar-quickcommerce-hackathon/main/assets/brands/swiggy.png',\n            qrData: {\n              qrImageUrl:\n                'https://raw.githubusercontent.com/prakhar-goel/hotstar-quickcommerce-hackathon/main/assets/qr-codes/shrikhand-swiggy.png',\n              title: 'Mango Shrikhand',\n            },\n          },\n          // {\n          //   imageUrl:\n          //     'https://instamart-media-assets.swiggy.com/swiggy/image/upload/fl_lossy,f_auto,q_auto,h_600/d2fe71ba49d3e43af5d99a3ce3ef5a1b',\n          //   title: 'Amul Fresh Cream',\n          //   description: 'Cook with Sanjeev Kapoor',\n          //   price: '₹220',\n          //   redirectUrl: 'https://swiggy.com/instamart/search?query=cream',\n          //   deliveryTime: '6 mins',\n          //   brandColor: '#FC8019',\n          //   brandLogoUrl:\n          //     'https://raw.githubusercontent.com/prakhar-goel/hotstar-quickcommerce-hackathon/main/assets/brands/swiggy-instamart.png',\n          //   qrData: {\n          //     qrImageUrl:\n          //       'https://raw.githubusercontent.com/prakhar-goel/hotstar-quickcommerce-hackathon/main/assets/qr-codes/amulcream-swiggy.png',\n          //     title: 'Amul Fresh Cream',\n          //   },\n          // },\n        ],\n      },\n      {\n        startTime: 17,\n        endTime: 25,\n        ads: [\n          {\n            imageUrl:\n              'https://media-assets.swiggy.com/swiggy/image/upload/fl_lossy,f_auto,q_auto,h_600/FOOD_CATALOG/IMAGES/CMS/2024/7/4/4e30b1ff-dbe8-41d3-b083-d46b9d742ffc_636d161e-7f34-4371-b63c-bf9e3d091a0f.jpg',\n            title: 'Veg Cheese Pizza',\n            description:\n              'Centre loaded with Molten Cheese & topped with Onion, Capsicum, Tomato & Grilled Mushroom *Contains non-edible container under the Pizza',\n            price: '₹149',\n            previousPrice: '₹299',\n            discount: '50% off for Hotstar users',\n            redirectUrl: 'https://swiggy.com/search?query=dominos+pizza',\n            deliveryTime: '28 mins',\n            brandLogoUrl:\n              'https://raw.githubusercontent.com/prakhar-goel/hotstar-quickcommerce-hackathon/main/assets/brands/swiggy.png',\n            brandColor: '#FC8019',\n            qrData: {\n              qrImageUrl:\n                'https://raw.githubusercontent.com/prakhar-goel/hotstar-quickcommerce-hackathon/main/assets/qr-codes/pizza-swiggy.png',\n              title: 'Cheese Volcano Blazing Chicken',\n            },\n          },\n          {\n            imageUrl:\n              'https://media-assets.swiggy.com/swiggy/image/upload/fl_lossy,f_auto,q_auto,h_600/oqaxbzhq3wxnyz09upie',\n            title: 'Mango Shrikhand',\n            description: 'Our most selling shrikhad with rich kesar taste',\n            price: '₹100',\n            previousPrice: '₹199',\n            discount: '50% off for Hotstar users',\n            redirectUrl: 'https://www.swiggy.com/search?query=shrikhand',\n            deliveryTime: '7 mins',\n            brandColor: '#FC8019',\n            brandLogoUrl:\n              'https://raw.githubusercontent.com/prakhar-goel/hotstar-quickcommerce-hackathon/main/assets/brands/swiggy.png',\n            qrData: {\n              qrImageUrl:\n                'https://raw.githubusercontent.com/prakhar-goel/hotstar-quickcommerce-hackathon/main/assets/qr-codes/shrikhand-swiggy.png',\n              title: 'Mango Shrikhand',\n            },\n          },\n          {\n            imageUrl:\n              'https://instamart-media-assets.swiggy.com/swiggy/image/upload/fl_lossy,f_auto,q_auto,h_600/d2fe71ba49d3e43af5d99a3ce3ef5a1b',\n            title: 'Amul Fresh Cream',\n            description: 'Cook with Sanjeev Kapoor',\n            price: '₹220',\n            redirectUrl: 'https://swiggy.com/instamart/search?query=cream',\n            deliveryTime: '6 mins',\n            brandColor: '#FC8019',\n            brandLogoUrl:\n              'https://raw.githubusercontent.com/prakhar-goel/hotstar-quickcommerce-hackathon/main/assets/brands/swiggy-instamart.png',\n            qrData: {\n              qrImageUrl:\n                'https://raw.githubusercontent.com/prakhar-goel/hotstar-quickcommerce-hackathon/main/assets/qr-codes/amulcream-swiggy.png',\n              title: 'Amul Fresh Cream',\n            },\n          },\n        ],\n      },\n    ],\n  },\n};\n\nexport const fetchAdData = (contentId: string): Promise<any> => {\n  return new Promise((res, rej) => {\n    try {\n      //* Removing trailing '/' from DataUrl\n      //* Fetching ad data\n      // fetch(\n      //   'https://raw.githubusercontent.com/prakhar-goel/hotstar-quickcommerce-hackathon/main/assets/data.json',\n      //   {\n      //     method: 'GET',\n      //     // headers: {\n      //     //   'Content-Type': 'application/json',\n      //     //   Accept: 'application/json',\n      //     // },\n      //   }\n      // )\n      //   .then(fetch_res => {\n      //     fetch_res.json().then((jsonData: []) => {\n      //       //* Sorting according ad data according to start_time\n      //       if (jsonData[contentId]) {\n      //         res(jsonData[contentId].triggerPoints);\n      //       } else {\n      //         rej('No data found');\n      //       }\n      //     });\n      //   })\n      //   .catch(err => {\n      //     rej(err);\n      //   });\n      if (sampleData[contentId]) {\n        res(sampleData[contentId].triggerPoints);\n      } else {\n        rej('No data found');\n      }\n    } catch (err) {\n      rej(err);\n    }\n  });\n};\n//* Finds video element according to the given data attribute ex: data-displaymaxtap\n// export const getVideoElement = (): HTMLVideoElement | undefined => {\n\n//     const elements = document.querySelectorAll(`[${Config.DataAttribute}]`);\n//     for (let i = 0; i < elements.length; i++) {\n//         if (elements[i].tagName === 'VIDEO') {\n//             return elements[i] as HTMLVideoElement;\n//         }\n\n//     }\n//     return undefined;\n// }\nexport const getVideoElement = (): HTMLVideoElement | undefined => {\n  const elements = document.querySelectorAll(`video`);\n  for (let i = 0; i < elements.length; i++) {\n    if (elements[i].tagName === 'VIDEO') {\n      return elements[i] as HTMLVideoElement;\n    }\n  }\n  return undefined;\n};\n\n//* Returns index of ad according to video current and ad start & end times which need to display\nexport const getCurrentComponentIndex = (\n  componentsData: AdComponentData[],\n  videoCurrentTimeInSeconds: number\n): number => {\n  for (let i = 0; i < componentsData.length; i++) {\n    const component = componentsData[i];\n    if (\n      // videoCurrentTimeInSeconds + Config.PrefetchImageTime >= component.starTime &&\n      videoCurrentTimeInSeconds >= component.startTime &&\n      videoCurrentTimeInSeconds <= component.endTime\n    ) {\n      return i;\n    }\n  }\n  //* If no are ads there to play returns -1\n  return -1;\n};\n//* Resize te ad_image according to video width\nexport const resizeComponentImgAccordingToVideo = () => {\n  let video = document.querySelector(`[${Config.DataAttribute}]`);\n  let ad_image_wrapper = document.querySelector(\n    `.${Config.classNames.image_wrapper}`\n  ) as HTMLDivElement;\n\n  if (\n    document.querySelector('.' + Config.classNames.image_wrapper) &&\n    window.innerWidth > 740 &&\n    video &&\n    ad_image_wrapper\n  ) {\n    let video_width = video.getBoundingClientRect().width;\n    let ad_width = (5 / 100) * video_width;\n    //* Min width of ad_image is 50px.\n    if (ad_width > 50) {\n      ad_image_wrapper.style.width = ad_width + 'px';\n    } else {\n      ad_image_wrapper.style.width = 50 + 'px';\n    }\n  }\n};\n//* Returns object which will send to Google Analytics\nexport const createGADict = (\n  current_component_data: AdComponentData\n): GaGeneric => {\n  return {\n    //content\n    client_id: current_component_data['client_id'],\n    client_name: current_component_data['client_name'] || 'null',\n    content_id: current_component_data['content_id'] || 'null',\n    content_name: current_component_data['content_name'] || 'null',\n    content_type: current_component_data['content_type'] || 'null',\n    show_name: current_component_data['show_name'] || 'null',\n    season: current_component_data['season'] || 'null',\n    episode_no: current_component_data['episode_no'] || 'null',\n    duration: current_component_data['duration'] || 'null',\n    content_language: current_component_data['content_language'] || 'null',\n\n    //advertiser\n    advertiser: current_component_data['advertiser'] || 'null',\n\n    caption_regional_language:\n      current_component_data['caption_regional_language'] || 'null',\n    caption: current_component_data['caption'] || 'null',\n    start_time: current_component_data['start_time'] || 'null',\n    end_time: current_component_data['end_time'] || 'null',\n\n    //product\n    gender: current_component_data['gender'] || 'null',\n    product_details: current_component_data['product_details'] || 'null',\n    product_article_type: current_component_data['article_type'] || 'null',\n    category: current_component_data['category'] || 'null',\n    subcategory: current_component_data['subcategory'] || 'null',\n    product_link: current_component_data['product_link'] || 'null',\n    product_image_link: current_component_data['image_link'] || 'null',\n    redirect_link: current_component_data['redirect_link'] || 'null',\n    //user\n    ad_viewed_count: current_component_data['ad_viewed_count'] || -1,\n\n    // device\n    browser_name: platform.name || 'null',\n    os_family: platform.os.family || 'null',\n    device_manufacturer: platform.manufacturer,\n    os_architecture: platform.os.architecture,\n    os_version: platform.os.version || 'null',\n    screen_resolution: `${screen.width}x${screen.height}`,\n    screen_orientation: screen.orientation.type,\n    full_screen: document.fullscreenEnabled,\n\n    //Version\n    plugin_version: LIB_VERSION,\n  };\n};\n","import Config, { clockSvg, shoppingBagSvg } from './config';\nimport { AdComponentData } from './types';\nimport {\n  fetchAdData,\n  getCurrentComponentIndex,\n  getVideoElement,\n  // createGADict,\n  resizeComponentImgAccordingToVideo,\n} from './utils';\n\nclass AdComponent {\n  private video?: HTMLVideoElement;\n  private parentElement: HTMLElement | null; //*  Parent element of video element\n  private currentComponentIndex = -1;\n  private componentsData?: Array<AdComponentData>;\n  private contentId: string;\n  private adDivComponent?: HTMLDivElement; //* Actual ad component (container📦) where ad_text and ad_image goes\n  private intervalId?: any;\n  private isInitialized = false;\n  constructor() {\n    this.parentElement = undefined;\n    this.intervalId = undefined;\n  }\n\n  public init = (data: { contentId: string }) => {\n    //* Check if the component is already initialized or ad is already present\n    if (\n      this.isInitialized ||\n      document.getElementById(Config.AdComponentElementId)\n    ) {\n      console.log('Re-Initializing');\n      return;\n    }\n    if (!data.contentId) {\n      console.error('ContentId is missing');\n      return;\n    }\n    try {\n      this.isInitialized = true;\n      this.contentId = data.contentId;\n\n      if (typeof window === 'undefined')\n        throw new ReferenceError(\n          \"'window.document' is undefined while initializing Ads. Initialize in lifecyle events\"\n        );\n\n      //* Adding google 📈 analytics script tag\n      /*   if (!document.getElementById('ga4-script')) {\n        const ga_script_element = document.createElement('script');\n        ga_script_element.src = `https://www.googletagmanager.com/gtag/js?id=${Config.GoogleAnalyticsCode}`;\n        ga_script_element.async = true;\n        ga_script_element.id = 'ga4-script';\n\n        window.dataLayer = window.dataLayer || [];\n        window.gtag = function () {\n          window.dataLayer.push(arguments);\n        };\n\n        ga_script_element.addEventListener('load', () => {\n          window.gtag('js', new Date());\n          window.gtag('config', Config.GoogleAnalyticsCode);\n        });\n\n        const head_tag = document.querySelector('head');\n        head_tag?.appendChild(ga_script_element);\n      } */\n\n      this.video = getVideoElement();\n\n      //*Fetching ad data\n      fetchAdData(this.contentId)\n        .then(data => {\n          this.componentsData = data;\n          if (!this.componentsData) {\n            console.error('Ad data is empty!');\n            return;\n          }\n\n          //* Adding ad component sibling to video element\n          this.addAdElement();\n\n          //* Resizing the ad_image when window resizes\n          window.addEventListener('resize', () => {\n            resizeComponentImgAccordingToVideo();\n          });\n          // //* Setting initial values\n          // for (let i = 0; i < this.componentsData.length; i++) {\n          //   this.componentsData[i]['ad_viewed_count'] = 0;\n          //   this.componentsData[i]['times_clicked'] = 0;\n          //   this.componentsData[i]['is_image_loaded'] = false;\n          //   this.componentsData[i]['image_error'] = false;\n          // }\n          //* Updating ad component for every 1s\n          this.intervalId = setInterval(this.updateComponent, 300);\n        })\n        .catch(err => {\n          console.error(err);\n        });\n    } catch (err) {\n      console.error(err);\n      this.isInitialized = false;\n    }\n  };\n\n  private updateComponent = () => {\n    //* Checking if video element is present\n    if (!this.video) {\n      //* Finding for video element until we get;\n      this.video = getVideoElement();\n      return;\n    }\n\n    if (!this.adDivComponent) {\n      this.addAdElement();\n      console.error('Ad element is not present', {\n        method: 'updateComponent',\n      });\n      return;\n    }\n    if (!this.componentsData) {\n      console.error('Ad data is empty!', {\n        method: 'updateComponent',\n      });\n      return;\n    }\n\n    //* Checking if ad element is 👬 sibling to video element every time\n    if (this.video.parentElement !== this.adDivComponent.parentElement) {\n      console.error('Ad element is not sibling to video element', {\n        method: 'updateComponent',\n      });\n      this.adDivComponent.remove();\n      if (!this.addAdElement()) {\n        console.error('Ad element is not present', {\n          method: 'updateComponent',\n        });\n        return;\n      }\n    }\n\n    //* Finding which ad to play at current video time.\n    const newAdComponentIndex = getCurrentComponentIndex(\n      this.componentsData,\n      Math.floor(this.video.currentTime)\n    );\n    console.log('newAdComponentIndex', newAdComponentIndex);\n    //* Displaying no ad.\n    if (newAdComponentIndex < 0) {\n      this.removeCurrentAdElement(this.adDivComponent);\n      return;\n    }\n    this.currentComponentIndex = newAdComponentIndex;\n    //* Checking if image is already cached else Pre-fetching ⬇️ image before 15 sec of ad.\n    // if (\n    //   !this.componentsData[this.currentComponentIndex]['is_image_loaded'] &&\n    //   !this.componentsData[this.currentComponentIndex]['image_error']\n    // ) {\n    //   this.prefetchAdImage();\n    // }\n\n    if (\n      this.canCloseAd(Math.floor(this.video.currentTime)) &&\n      this.adDivComponent.style.display !== 'none'\n    ) {\n      console.log('Removing ad', {\n        methodName: 'updateComponent',\n      });\n      this.removeCurrentAdElement(this.adDivComponent);\n    }\n    if (\n      this.canAdDisplay(Math.floor(this.video.currentTime)) &&\n      this.adDivComponent &&\n      this.adDivComponent.style.display === 'none'\n      // !this.componentsData[this.currentComponentIndex]['image_error'] &&\n      // this.componentsData[this.currentComponentIndex]['is_image_loaded']\n    ) {\n      console.log('Displaying ad', {\n        methodName: 'updateComponent',\n      });\n      this.displayAd();\n    }\n  };\n\n  //* 💉 Inserting ad component inside DOM\n  private addAdElement = (): boolean => {\n    if (!this.video) {\n      return false;\n    }\n    this.video.style.width = '100%';\n    this.video.style.height = '100%';\n    this.parentElement = this.video.parentElement;\n    if (!this.parentElement) {\n      return false;\n    }\n    //* Adding ad-element 👬 sibling to video element\n\n    this.parentElement.style.position = 'relative';\n    this.adDivComponent = document.createElement('div');\n    this.adDivComponent.style.display = 'none';\n    this.adDivComponent.id = Config.AdComponentElementId;\n    this.adDivComponent.className = 'hotstar_ad_component_wrapper';\n    this.parentElement?.appendChild(this.adDivComponent);\n    this.adDivComponent.addEventListener('click', this.redirectToAd);\n    resizeComponentImgAccordingToVideo();\n    return true;\n  };\n  //* Loading and caching image 🖼️\n  /*   private prefetchAdImage = () => {\n    if (!this.componentsData) {\n      return;\n    }\n    let img = new Image();\n    this.componentsData[this.currentComponentIndex]['is_image_loaded'] = true;\n    img.onerror = () => {\n      this.componentsData[this.currentComponentIndex]['image_error'] = true;\n    };\n    img.src = this.componentsData[this.currentComponentIndex]['image_link'];\n  }; */\n\n  //* Checks if ad can show up at given video time\n  private canAdDisplay = (currentTimeInSecs: number): boolean => {\n    const current_component = this.componentsData[this.currentComponentIndex];\n\n    if (\n      current_component.startTime < 0 ||\n      !this.componentsData ||\n      !current_component\n      // !current_component.is_image_loaded\n    ) {\n      return false;\n    }\n\n    //* Checking if video current time is in range ⬅️➡️ of ad start time and ad end time\n    if (\n      currentTimeInSecs <\n        this.componentsData[this.currentComponentIndex]['endTime'] &&\n      currentTimeInSecs >\n        this.componentsData[this.currentComponentIndex]['startTime']\n    ) {\n      return true;\n    }\n    return false;\n  };\n\n  //* Checking if video current time is not in range ⬅️➡️ of ad start time and ad end time\n\n  private canCloseAd = (currentTimeInSecs: number): boolean => {\n    if (!this.componentsData) return true;\n    if (this.componentsData[this.currentComponentIndex].startTime < 0) {\n      return false;\n    }\n    if (\n      currentTimeInSecs >\n        this.componentsData[this.currentComponentIndex]['endTime'] ||\n      currentTimeInSecs <\n        this.componentsData[this.currentComponentIndex]['startTime']\n    ) {\n      return true;\n    }\n    return false;\n  };\n  //*❎ Removing innerHtml from  main container\n  private removeCurrentAdElement = (main_component: HTMLDivElement) => {\n    if (!main_component) return;\n    main_component.style.display = 'none';\n    main_component.innerHTML = '';\n  };\n\n  //* Adding innerHtml into main container and making it's display flex\n  private displayAd = (): void => {\n    if (!this.adDivComponent || !this.componentsData) {\n      console.error('Ad element is not present', {\n        method: 'displayAd',\n        adDivComponent: this.adDivComponent,\n        componentsData: this.componentsData,\n      });\n      return;\n    }\n    if (this.adDivComponent.style.display === 'flex') return;\n    if (\n      this.currentComponentIndex < 0 ||\n      !this.componentsData[this.currentComponentIndex]\n    )\n      return;\n\n    const currentAdData = this.componentsData[this.currentComponentIndex];\n    if (currentAdData.ads.length > 3) {\n      currentAdData.ads = currentAdData.ads.slice(0, 3);\n    }\n\n    const shopButton = document.createElement('button');\n    shopButton.className = 'shop-button';\n    shopButton.innerHTML = `${shoppingBagSvg}<span>Shop</span>`;\n    this.adDivComponent.appendChild(shopButton);\n\n    for (let i = 0; i < currentAdData.ads.length && i < 3; ) {\n      const itemCardData = currentAdData.ads[i];\n      const descriptionText =\n        itemCardData.description.length > 70\n          ? itemCardData.description.slice(0, 70) + '...'\n          : itemCardData.description;\n      const item = document.createElement('a');\n\n      let title = itemCardData.title;\n      let priceHtml = ``;\n      let descriptionHtml = ``;\n      if (!itemCardData.previousPrice) {\n        title = `${itemCardData.title} (${itemCardData.price})`;\n        descriptionHtml = `<p class=\"description\">${descriptionText}</p>`;\n      } else {\n        priceHtml = `<p class=\"price\">\n          <strong>${itemCardData.price}</strong>\n          <span class=\"previous_price\">${itemCardData.previousPrice}</span>\n          <span class=\"discount\" style=\"color:${itemCardData.brandColor}!important;\">(${itemCardData.discount})</span>\n        </p>`;\n      }\n      item.onclick = () => {\n        document\n          .querySelectorAll('.qr_container')\n          .forEach((qr: HTMLDivElement) => {\n            qr.style.display = 'none';\n          });\n        document.getElementById(`qr_card_${i}`).style.display = 'flex';\n      };\n      item.className = 'ad_item_card';\n      item.href = itemCardData.redirectUrl;\n      item.target = '_blank';\n      item.innerHTML = `\n      <img src=\"${itemCardData.imageUrl}\" alt=\"${itemCardData.title}\"/>\n      <div class=\"ad_item_card_content\">\n        <h3 class=\"title\">${title}</h3>\n        ${descriptionHtml}\n        ${priceHtml}\n        <div class=\"footer\">\n          <div class=\"delivery_time\">${clockSvg}<p>${itemCardData.deliveryTime}</p></div>\n          <img class=\"brand\" src=\"${itemCardData.brandLogoUrl}\" alt=\"brand-logo\"/>\n        </div>\n      </div>\n      `;\n      this.adDivComponent.appendChild(item);\n    }\n\n    // if (currentAdData.ads.length > 0) {\n    //   // Put \"Or\" text\n    //   const orText = document.createElement('p');\n    //   orText.className = 'or_text';\n    //   orText.innerHTML = 'OR';\n    //   this.adDivComponent.appendChild(orText);\n    // }\n    for (let i = 0; i < currentAdData.ads.length; i++) {\n      const adData = currentAdData.ads[i];\n      if (adData.qrData) {\n        const qrCard = document.createElement('div');\n        qrCard.className = 'qr_container';\n        qrCard.id = `qr_card_${i}`;\n        qrCard.innerHTML = `<img src=\"${adData.qrData.qrImageUrl}\" alt=\"${adData.qrData.title}\"/>`;\n        qrCard.style.display = i === 0 ? 'flex' : 'none';\n        this.adDivComponent.appendChild(qrCard);\n      }\n    }\n    this.adDivComponent.style.display = 'flex';\n    // main_component.innerHTML = component_html;\n\n    // * Incrementing ⬆️️ no of times ad is viewed 👁️.\n    // this.componentsData[this.currentComponentIndex]['ad_viewed_count']++;\n    // const current_component_data = this.componentsData[\n    //   this.currentComponentIndex\n    // ];\n\n    //* Triggering 👀 Impression  📈📈 Google Analytics events\n    // const ga_impression_data = createGADict(current_component_data);\n    // window.gtag('event', 'impression', ga_impression_data);\n  };\n\n  //* Redirecting to ad🔗link in new tab\n  private redirectToAd = (): void => {\n    try {\n      if (!this.componentsData) {\n        return;\n      }\n      this.video.pause();\n      //* Increasing ⬆️ no of times clicked 🖱️\n      // this.componentsData[this.currentComponentIndex]['times_clicked']++;\n      // const current_component_data = this.componentsData[\n      //   this.currentComponentIndex\n      // ];\n      // var ga_click_data = createGADict(current_component_data);\n      // ga_click_data['event_category'] = 'click';\n      // ga_click_data['time_to_click'] = Math.floor(\n      //   this.video.currentTime -\n      //     this.componentsData[this.currentComponentIndex]['start_time']\n      // );\n      // ga_click_data['times_clicked'] = current_component_data['times_clicked'];\n      //* Triggering 🖱️ Click  📈📈 Google Analytics events\n      // window.gtag('event', 'click', ga_click_data);\n      // window.open(\n      //   this.componentsData![this.currentComponentIndex].redirect_link,\n      //   '_blank'\n      // );\n    } catch (err) {\n      console.error(err);\n    }\n  };\n\n  //*❎ Remove ad from DOM, stop updating ad and re-set all class variables\n  public removeAd(): void {\n    //* Stopping loop\n    clearInterval(this.intervalId);\n\n    this.isInitialized = false;\n    //* Resetting class variables\n    this.video,\n      this.parentElement,\n      this.componentsData,\n      this.intervalId,\n      (this.adDivComponent = undefined);\n    this.currentComponentIndex = 0;\n    this.removeCurrentAdElement(\n      document.getElementById(Config.AdComponentElementId) as HTMLDivElement\n    );\n    //* Removing element form dom\n    document.getElementById(Config.AdComponentElementId)?.remove();\n  }\n}\n/* \n* Instantiate a AdComponent object and exporting it\n* So that we can import component anywhere we want and the component will be same throughout the whole project\n\n? Saves us from unnecessary initalization of component\n*/\nexport default new AdComponent();\n","import './styles.css';\nimport { LIB_VERSION } from './version';\nconsole.log(`ads_plugin@${LIB_VERSION}`);\nexport { default as AdComponent } from './app';\n"],"names":["LIB_VERSION","config","GoogleAnalyticsCode","AdComponentElementId","DataAttribute","classNames","image_wrapper","PrefetchImageTime","DataUrl","shoppingBagSvg","clockSvg","sampleData","contentId","triggerPoints","startTime","endTime","ads","imageUrl","title","description","price","previousPrice","discount","redirectUrl","deliveryTime","brandLogoUrl","brandColor","qrData","qrImageUrl","fetchAdData","Promise","res","rej","err","getVideoElement","elements","document","querySelectorAll","i","length","tagName","undefined","getCurrentComponentIndex","componentsData","videoCurrentTimeInSeconds","component","resizeComponentImgAccordingToVideo","video","querySelector","Config","ad_image_wrapper","window","innerWidth","video_width","getBoundingClientRect","width","ad_width","style","AdComponent","data","isInitialized","getElementById","console","log","error","ReferenceError","then","addAdElement","addEventListener","intervalId","setInterval","updateComponent","adDivComponent","method","parentElement","remove","newAdComponentIndex","Math","floor","currentTime","removeCurrentAdElement","currentComponentIndex","canCloseAd","display","methodName","canAdDisplay","displayAd","height","position","createElement","id","className","appendChild","redirectToAd","currentTimeInSecs","current_component","main_component","innerHTML","currentAdData","slice","shopButton","itemCardData","descriptionText","item","priceHtml","descriptionHtml","onclick","forEach","qr","href","target","adData","qrCard","pause","removeAd","clearInterval"],"mappings":"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"}